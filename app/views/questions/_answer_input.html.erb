<script type="text/javascript">
$(document).ready(function() {

  <%if @question.answer_plus != nil || @question.answer_plus == true%>
    $('#answer-button').show();
    $('#otherInputBox').show();
  <%else%>
    $('#answer-button').show();
    $('#otherInputBox').hide();
  <%end%>

  <%if @user_submitted_answer%>
    $('.question-title-container').css("height", "180px");
    $('.question-container').css("height", "180px");
  <%else%>
    $('.question-title-container').css("height", "280px");
    $('.question-container').css("height", "280px");
  <%end%>

  $('#other').keyup(function() {
    if($(this).val() != '') {
       $('.other-button').removeAttr('disabled');
    }
  });

  $("form").bind("keypress", function (e) {
      if (e.keyCode == 13) {
          return false;
      }
  });

});
</script>

<div class="answer-prompt">
<% if @question == nil %>
<% @question = Question.where(slug: params[:id])[0] %>
<% end %>

<% if @answer == nil %>
<% @answer = user_signed_in? ? @question.answers.build(user_id: current_user.id) : @question.answers.build(user_id: cookies[:guest]) %>
<% end %>

  <% if cookies[:guest] != nil %>
    <%= simple_form_for @answer, url: question_answers_path(@question, @answer), class: "form-inline", role: "form", html: {novalidate: false} do |f| %>
      <div class="form-group">
        <% if @question.input_type == "measurement" %>
          <section class="question-dual-input">
            <%= f.input(:value, label: false, pattern: "\d*", placeholder: @user_units["large_unit"]) %>
            <%= f.input(:value, label: false, pattern: "\d*", placeholder: @user_units["small_unit"]) %>
          </section>
        <% elsif @question.input_type == "collection" %>
          <section id="input-dropdown">
            <%= f.input(:value, label: false, prompt: "Select an Answer", collection: @question.options_array, input_html: { class: "questions-page-input form-control input-lg"}) %>
          </section>
        <% end %>
        <div class="modal-save-wrapper text-center" id="answer-button">
          <% if !@user_submitted_answer %>
            <%= f.submit "Answer", class: "modal-button", disabled: true, data: {disable_with: "Submitting..."} %>
          <% end %>
    <% end %>
        </div>
        <% if !@user_submitted_answer %>
          <div id="otherInputBox">
            <%# if current_user %>
              <%= simple_form_for @question, url: question_path, html: { multipart: true, novalidate: false } do |f| %>
                <%= f.input(:options_for_collection, label: false, input_html:{ value: nil, placeholder: "Or add your answer to the list", class: "other-input-text", id:"other"}) %>
                <%= f.submit "Answer", class: "other-button", disabled: true, data: {disable_with: "Submitting..."} %>
              <% end %>
            <%# else %>
              <!--<p class="question-title" style="margin-top: 1em;"> Don't have an account? <%#= link_to "Sign up!", new_registration_path(resource_name) %> <p>-->
            <%# end %>
          </div>
        <% end %>
      </div>
  <% end %>
</div>
